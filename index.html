<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TFT 시즌 16 퀴즈</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0a1a;color:#e0e0e0;font-family:'Segoe UI',sans-serif;min-height:100vh;display:flex;justify-content:center;padding:20px}
.app{max-width:700px;width:100%}
h1{text-align:center;color:#c89b3c;font-size:1.6rem;margin-bottom:8px}
.subtitle{text-align:center;color:#785a28;font-size:.85rem;margin-bottom:20px}
.stats{display:flex;justify-content:center;gap:20px;margin-bottom:20px;font-size:.9rem}
.stats span{background:#1a1a2e;padding:6px 14px;border-radius:8px;color:#c89b3c}
.quiz-box{background:#1a1a2e;border:1px solid #2a2a4a;border-radius:12px;padding:24px;margin-bottom:20px}
.q-type{color:#785a28;font-size:.8rem;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}
.q-text{font-size:1.2rem;color:#fff;margin-bottom:16px;line-height:1.5}
.q-text .highlight{color:#c89b3c;font-weight:bold}
.input-area{margin-bottom:16px}
.input-area textarea{width:100%;background:#0d0d20;border:1px solid #3a3a5a;border-radius:8px;color:#e0e0e0;padding:12px;font-size:1rem;resize:vertical;min-height:80px;font-family:inherit}
.input-area textarea:focus{outline:none;border-color:#c89b3c}
.input-area textarea::placeholder{color:#555}
.btn-row{display:flex;gap:10px;flex-wrap:wrap}
.btn{padding:10px 20px;border:none;border-radius:8px;font-size:.95rem;cursor:pointer;font-weight:600;transition:all .2s}
.btn-answer{background:#c89b3c;color:#0a0a1a}
.btn-answer:hover{background:#ddb04b}
.btn-next{background:#2a4a2a;color:#8f8}
.btn-next:hover{background:#3a6a3a}
.btn-skip{background:#2a2a4a;color:#aaa}
.btn-skip:hover{background:#3a3a5a}
.answer-box{background:#0d0d20;border:1px solid #3a5a3a;border-radius:8px;padding:16px;margin-top:16px;display:none}
.answer-box.show{display:block}
.answer-box h3{color:#c89b3c;margin-bottom:8px;font-size:.95rem}
.answer-box .answer-content{color:#8f8;font-size:1rem;line-height:1.6;white-space:pre-wrap}
.settings{background:#1a1a2e;border:1px solid #2a2a4a;border-radius:12px;padding:20px;margin-top:10px}
.settings h2{color:#c89b3c;font-size:1rem;margin-bottom:12px}
.chk-group{display:flex;flex-wrap:wrap;gap:8px}
.chk-group label{display:flex;align-items:center;gap:6px;background:#0d0d20;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:.85rem;border:1px solid #2a2a4a;transition:all .2s}
.chk-group label:hover{border-color:#c89b3c}
.chk-group input:checked+span{color:#c89b3c}
.cost-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.75rem;font-weight:bold;margin-left:6px}
.cost-1{background:#848484;color:#fff}
.cost-2{background:#11b288;color:#fff}
.cost-3{background:#207ac7;color:#fff}
.cost-4{background:#c440da;color:#fff}
.cost-5{background:#ffb93b;color:#000}
.cost-7{background:#ff4444;color:#fff}
.unlock-badge{color:#ff9800;font-size:.8rem;margin-left:4px}
.srs-info{text-align:center;font-size:.75rem;color:#555;margin-bottom:12px}
.srs-info .box-tag{display:inline-block;padding:1px 6px;border-radius:4px;margin-left:4px;font-size:.7rem}
.wiki-link{display:inline-block;margin-top:8px;padding:10px 20px;background:#c89b3c;color:#0a0a1a;border-radius:8px;text-decoration:none;font-weight:600;font-size:.95rem;transition:all .2s}
.wiki-link:hover{background:#ddb04b;transform:translateY(-1px)}
.box-0{background:#ff4444;color:#fff}
.box-1{background:#ff8800;color:#fff}
.box-2{background:#ccaa00;color:#000}
.box-3{background:#66aa00;color:#fff}
.box-4{background:#22aa66;color:#fff}
.box-5{background:#2288cc;color:#fff}
.settings-row{margin-top:12px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
.btn-sm{padding:6px 12px;border:none;border-radius:6px;font-size:.8rem;cursor:pointer;background:#2a2a4a;color:#aaa}
.btn-sm:hover{background:#3a3a5a}
</style>
</head>
<body>
<div class="app">
<h1>TFT 시즌 16 퀴즈</h1>
<p class="subtitle">신화와 전설 - 인출 연습</p>
<div class="stats">
<span>문제: <b id="qNum">0</b></span>
<span>연속: <b id="streak">0</b></span>
<span>숙달: <b id="mastery">0%</b></span>
</div>
<div class="srs-info" id="srsInfo"></div>
<div class="quiz-box">
<div class="q-type" id="qType"></div>
<div class="q-text" id="qText"></div>
<div class="input-area">
<textarea id="userInput" placeholder="정답을 입력하세요..."></textarea>
</div>
<div class="btn-row">
<button class="btn btn-answer" id="btnShow">정답 보기</button>
<button class="btn btn-next" id="btnCorrect" style="display:none">맞았다 ✓</button>
<button class="btn btn-skip" id="btnWrong" style="display:none">틀렸다 ✗</button>
</div>
<div class="answer-box" id="answerBox">
<h3>정답</h3>
<div class="answer-content" id="answerContent"></div>
</div>
</div>
<div class="settings">
<h2>퀴즈 유형 선택</h2>
<div class="chk-group">
<label><input type="checkbox" checked data-type="champSynergy"><span>챔피언→시너지</span></label>
<label><input type="checkbox" checked data-type="synergyChamp"><span>시너지→챔피언</span></label>
<label><input type="checkbox" checked data-type="unlock"><span>해금 조건</span></label>
<label><input type="checkbox" checked data-type="item"><span>아이템 조합</span></label>
<label><input type="checkbox" checked data-type="synergyEffect"><span>시너지 효과</span></label>
<label><input type="checkbox" checked data-type="radiantItem"><span>찬란한 아이템</span></label>
<label><input type="checkbox" checked data-type="artifactItem"><span>유물 아이템</span></label>
</div>
<div class="settings-row">
<span style="color:#785a28;font-size:.8rem">학습 데이터는 브라우저에 자동 저장됩니다</span>
<button class="btn-sm" id="btnReset" title="학습 기록 초기화">초기화</button>
</div>
</div>
</div>
<script>
// ===== 챔피언 데이터 =====
const champions = [
// 1코스트
{name:"애니비아",cost:1,traits:["프렐요드","기원자"]},
{name:"블리츠크랭크",cost:1,traits:["자운","전쟁기계"]},
{name:"브라이어",cost:1,traits:["녹서스","학살자","전쟁기계"]},
{name:"케이틀린",cost:1,traits:["필트오버","원거리 사격"]},
{name:"일라오이",cost:1,traits:["빌지워터","난동꾼"]},
{name:"자르반 4세",cost:1,traits:["데마시아","엄호대"]},
{name:"진",cost:1,traits:["아이오니아","총잡이"]},
{name:"코그모",cost:1,traits:["공허","비전 마법사","원거리 사격"]},
{name:"룰루",cost:1,traits:["요들","비전 마법사"]},
{name:"키아나",cost:1,traits:["이쉬탈","학살자"]},
{name:"럼블",cost:1,traits:["요들","엄호대"]},
{name:"쉔",cost:1,traits:["아이오니아","난동꾼"]},
{name:"소나",cost:1,traits:["데마시아","기원자"]},
{name:"비에고",cost:1,traits:["그림자 군도","기동타격대"]},
// 2코스트
{name:"아펠리오스",cost:2,traits:["타곤"]},
{name:"애쉬",cost:2,traits:["프렐요드","기동타격대"]},
{name:"바드",cost:2,traits:["관리인"],unlock:"스테이지 2 회전석 전까지 리롤 4회"},
{name:"초가스",cost:2,traits:["공허","전쟁기계"]},
{name:"에코",cost:2,traits:["자운","방해꾼"]},
{name:"그레이브즈",cost:2,traits:["빌지워터","총잡이"],unlock:"아이템 2개를 장착한 트위스티드 페이트를 전투에 배치"},
{name:"니코",cost:2,traits:["이쉬탈","비전 마법사","엄호대"]},
{name:"오리아나",cost:2,traits:["필트오버","기원자"],unlock:"필트오버 챔피언에 아이템 2개 장착"},
{name:"뽀삐",cost:2,traits:["데마시아","요들","전쟁기계"],unlock:"데마시아 또는 요들 챔피언에 아이템 2개 장착하고 전투 배치"},
{name:"렉사이",cost:2,traits:["공허","토벌자"]},
{name:"사이온",cost:2,traits:["녹서스","난동꾼"]},
{name:"티모",cost:2,traits:["요들","원거리 사격"]},
{name:"트리스타나",cost:2,traits:["요들","총잡이"]},
{name:"트린다미어",cost:2,traits:["프렐요드","학살자"],unlock:"아이템 1개를 장착한 애쉬를 전투에 배치"},
{name:"트위스티드 페이트",cost:2,traits:["빌지워터","기동타격대"]},
{name:"바이",cost:2,traits:["필트오버","자운","엄호대"]},
{name:"신 짜오",cost:2,traits:["데마시아","아이오니아","파수꾼"]},
{name:"야스오",cost:2,traits:["아이오니아","학살자"]},
{name:"요릭",cost:2,traits:["그림자 군도","파수꾼"],unlock:"아이템 1개를 장착한 2성 비에고를 전투에 배치"},
// 3코스트
{name:"아리",cost:3,traits:["아이오니아","비전 마법사"]},
{name:"다리우스",cost:3,traits:["녹서스","엄호대"],unlock:"드레이븐이 골드 1개를 드랍"},
{name:"드레이븐",cost:3,traits:["녹서스","기동타격대"]},
{name:"문도 박사",cost:3,traits:["자운","난동꾼"]},
{name:"갱플랭크",cost:3,traits:["빌지워터","학살자","토벌자"]},
{name:"그웬",cost:3,traits:["그림자 군도","방해꾼"],unlock:"영혼 20개 수집"},
{name:"징크스",cost:3,traits:["자운","총잡이"]},
{name:"케넨",cost:3,traits:["아이오니아","요들","엄호대"],unlock:"아이오니아/요들/엄호대 별 레벨 합계 7 이상"},
{name:"코부코와 유미",cost:3,traits:["요들","난동꾼","기원자"],unlock:"난동꾼/요들/기원자 별 레벨 합계 6 이상 + 레벨 7"},
{name:"르블랑",cost:3,traits:["녹서스","기원자"],unlock:"아이템 2개를 장착한 사이온을 전투에 배치"},
{name:"레오나",cost:3,traits:["타곤"]},
{name:"로리스",cost:3,traits:["필트오버","파수꾼"]},
{name:"말자하",cost:3,traits:["공허","방해꾼"]},
{name:"밀리오",cost:3,traits:["이쉬탈","기원자"]},
{name:"노틸러스",cost:3,traits:["빌지워터","전쟁기계","파수꾼"]},
{name:"세주아니",cost:3,traits:["프렐요드","엄호대"]},
{name:"베인",cost:3,traits:["데마시아","원거리 사격"]},
{name:"조이",cost:3,traits:["타곤"]},
// 4코스트
{name:"암베사",cost:4,traits:["녹서스","토벌자"]},
{name:"브라움",cost:4,traits:["프렐요드","파수꾼"]},
{name:"벨베스",cost:4,traits:["공허","학살자"]},
{name:"다이애나",cost:4,traits:["타곤"],unlock:"아이템 3개를 장착한 2성 레오나를 전투에 배치 + 레벨 6"},
{name:"피즈",cost:4,traits:["빌지워터","요들"],unlock:"요들 또는 빌지워터 유닛 5개 배치 + 레벨 7"},
{name:"가렌",cost:4,traits:["데마시아","엄호대"]},
{name:"카이사",cost:4,traits:["흡수자","공허","원거리 사격"],unlock:"아이템 3개를 장착한 원거리 사격 챔피언 전투 배치 + 레벨 7"},
{name:"칼리스타",cost:4,traits:["그림자 군도","토벌자"],unlock:"영혼 75개 수집"},
{name:"리산드라",cost:4,traits:["프렐요드","기원자"]},
{name:"럭스",cost:4,traits:["데마시아","비전 마법사"]},
{name:"미스 포츈",cost:4,traits:["빌지워터","총잡이"]},
{name:"나서스",cost:4,traits:["슈리마"],unlock:"아지르와 함께 전투 연속 패배 2/3/5회 (슈리마 해금 수에 따라 증가)"},
{name:"니달리",cost:4,traits:["이쉬탈","사냥꾼"],unlock:"2성 니코 2명을 함께 전투에 배치"},
{name:"레넥톤",cost:4,traits:["슈리마"],unlock:"아지르와 함께 전투 연속 승리 2/3/5회 (슈리마 해금 수에 따라 증가)"},
{name:"전령",cost:4,traits:["공허","난동꾼"],unlock:"공허 시너지를 8번의 플레이어 전투 동안 활성화"},
{name:"세라핀",cost:4,traits:["필트오버","방해꾼"]},
{name:"스카너",cost:4,traits:["이쉬탈"],unlock:"가고일 돌갑옷을 장착한 비탱커 유닛 배치 + 레벨 7"},
{name:"신지드",cost:4,traits:["자운","전쟁기계"],unlock:"플레이어 체력 35 이상 잃기 + 자운/전쟁기계 유닛 4개"},
{name:"스웨인",cost:4,traits:["녹서스","비전 마법사","전쟁기계"]},
{name:"타릭",cost:4,traits:["타곤"]},
{name:"베이가",cost:4,traits:["요들","비전 마법사"],unlock:"라바돈의 죽음모자 2개를 장착한 유닛을 전투에 배치"},
{name:"워윅",cost:4,traits:["자운","기동타격대"],unlock:"바이와 징크스에 각각 아이템 1개 장착 + 레벨 7"},
{name:"오공",cost:4,traits:["아이오니아","난동꾼"]},
{name:"요네",cost:4,traits:["아이오니아","학살자"],unlock:"3성 야스오"},
{name:"유나라",cost:4,traits:["아이오니아","기동타격대"]},
// 5코스트
{name:"아트록스",cost:5,traits:["다르킨","종말의 화신","학살자"],unlock:"전투에서 모든 피해 흡혈 40% 이상인 유닛 배치 + 레벨 8"},
{name:"애니",cost:5,traits:["어둠의 아이","비전 마법사"]},
{name:"아지르",cost:5,traits:["슈리마","황제","방해꾼"]},
{name:"피들스틱",cost:5,traits:["수확자","토벌자"]},
{name:"갈리오",cost:5,traits:["데마시아","영웅"],unlock:"데마시아 별 레벨 합계 12"},
{name:"킨드레드",cost:5,traits:["영원","기동타격대"]},
{name:"루시안과 세나",cost:5,traits:["영혼 결속","총잡이"]},
{name:"멜",cost:5,traits:["녹서스","방해꾼"],unlock:"2성 암베사가 아이템 1개 장착 상태로 사망"},
{name:"오른",cost:5,traits:["대장장이","파수꾼"]},
{name:"세트",cost:5,traits:["아이오니아","우두머리"],unlock:"레벨 8 + 전투 시작 시 앞 2줄에 유닛 1개만 배치"},
{name:"쉬바나",cost:5,traits:["용족","전쟁기계"]},
{name:"T-헥스",cost:5,traits:["헥스 기계","필트오버","총잡이"],unlock:"필트오버 별 레벨 합계 9"},
{name:"탐 켄치",cost:5,traits:["빌지워터","대식가","난동꾼"],unlock:"은빛 뱀 화폐 450 사용"},
{name:"쓰레쉬",cost:5,traits:["그림자 군도","파수꾼"],unlock:"영혼 150개 수집"},
{name:"티버",cost:5,traits:["비전 마법사"]},
{name:"볼리베어",cost:5,traits:["프렐요드","난동꾼"],unlock:"레벨 8 + 체력 3800 이상인 유닛 배치"},
{name:"제라스",cost:5,traits:["슈리마","초월체"],unlock:"아지르와 함께 승패를 번갈아 3/4/6회 반복 (슈리마 해금 수에 따라 증가)"},
{name:"직스",cost:5,traits:["자운","요들","원거리 사격"],unlock:"아이템 3개를 장착한 요들 또는 자운 유닛 배치 + 레벨 9"},
{name:"질리언",cost:5,traits:["시간의 수호자","기원자"]},
// 7코스트
{name:"아우렐리온 솔",cost:7,traits:["타곤","별의 창조자"],unlock:"전투에서 타곤 5 활성화"},
{name:"내셔 남작",cost:7,traits:["공허","균열의 재앙"],unlock:"레벨 10 + 공허 7 활성화"},
{name:"브록",cost:7,traits:["이쉬탈"],unlock:"이쉬탈 단서 총 500개 수집"},
{name:"라이즈",cost:7,traits:["룬 마법사"],unlock:"전투에서 4개 지역 시너지를 동시에 활성화 + 레벨 9"},
{name:"사일러스",cost:7,traits:["쇄극자","비전 마법사","엄호대"],unlock:"2성 자르반 4세, 가렌, 럭스를 상점에 판매"},
{name:"자헨",cost:7,traits:["다르킨","불멸자"],unlock:"신 짜오 챔피언 증강 획득 + 3성 신 짜오를 5라운드 동안 전투 배치"},
];

// ===== 아이템 데이터 =====
const items = [
{name:"적응형 투구",c1:"음전자 망토",c2:"여신의 눈물",effect:"모든 곳에서 얻는 마나 15% 증가. 탱커/싸움꾼: 방어력, 마법 저항력 35 획득. 그 외: 공격력 15, 주문력 15 획득"},
{name:"대천사의 지팡이",c1:"쓸데없이 큰 지팡이",c2:"여신의 눈물",effect:"전투 시작: 전투 중 5초마다 주문력 20 획득"},
{name:"피바라기",c1:"B.F. 대검",c2:"음전자 망토",effect:"전투 중 1회, 체력 40% 이하 시 최대 체력의 25% 보호막 획득 (5초 지속)"},
{name:"푸른 파수꾼",c1:"여신의 눈물",c2:"여신의 눈물",effect:"모든 곳에서 얻는 공격력, 주문력 10% 추가 획득"},
{name:"덤불 조끼",c1:"쇠사슬 조끼",c2:"쇠사슬 조끼",effect:"최대 체력 7% 획득. 기본 공격 피해 8% 감소. 기본 공격 피격 시 인접 적에게 마법 피해 100 (쿨다운 2초)"},
{name:"크라운가드",c1:"쇠사슬 조끼",c2:"쓸데없이 큰 지팡이",effect:"전투 시작: 최대 체력의 25% 보호막 (8초). 보호막 만료 시 주문력 25 획득"},
{name:"죽음의 검",c1:"B.F. 대검",c2:"B.F. 대검",effect:"공격력 55% 증가"},
{name:"용의 발톱",c1:"음전자 망토",c2:"음전자 망토",effect:"최대 체력 9% 획득. 2초마다 최대 체력의 2.5% 회복"},
{name:"밤의 끝자락",c1:"B.F. 대검",c2:"쇠사슬 조끼",effect:"생명선: 체력 60% 이하 시 잠시 대상 지정 불가 상태가 되며 해로운 효과 제거"},
{name:"저녁갑주",c1:"거인의 허리띠",c2:"음전자 망토",effect:"2칸 내 적에게 파쇄 30% 적용. 전투 시작 후 15초 동안 방어력 25, 마법 저항력 25 획득"},
{name:"가고일 돌갑옷",c1:"쇠사슬 조끼",c2:"음전자 망토",effect:"자신을 공격하는 적 1명당 방어력 10, 마법 저항력 10 획득"},
{name:"거인 학살자",c1:"B.F. 대검",c2:"곡궁",effect:"탱커 상대 피해 증폭 15% 획득"},
{name:"구인수의 격노검",c1:"쓸데없이 큰 지팡이",c2:"곡궁",effect:"매초 공격 속도 6% 획득 (무한 중첩)"},
{name:"정의의 손길",c1:"연습용 장갑",c2:"여신의 눈물",effect:"2가지 효과 획득: 공격력 15%, 주문력 15 / 모든 피해 흡혈 12%. 체력 50% 초과 시 공격력·주문력 2배, 50% 이하 시 흡혈 2배"},
{name:"마법공학 총검",c1:"B.F. 대검",c2:"쓸데없이 큰 지팡이",effect:"입힌 피해의 20%만큼 체력 비율이 가장 낮은 아군 회복"},
{name:"무한의 대검",c1:"B.F. 대검",c2:"연습용 장갑",effect:"스킬에 치명타 적용 가능. 이미 치명타가 가능하면 치명타 피해 10% 증가"},
{name:"이온 충격기",c1:"쓸데없이 큰 지팡이",c2:"음전자 망토",effect:"2칸 내 적에게 쇄약 30% 적용. 적이 스킬 시전 시 소모 마나의 150%만큼 마법 피해"},
{name:"보석 건틀릿",c1:"쓸데없이 큰 지팡이",c2:"연습용 장갑",effect:"스킬에 치명타 적용 가능. 이미 치명타가 가능하면 치명타 피해 10% 증가"},
{name:"최후의 속삭임",c1:"곡궁",c2:"연습용 장갑",effect:"물리 피해 시 대상에게 3초 동안 파열 30% 적용 (중첩 불가)"},
{name:"모렐로노미콘",c1:"쓸데없이 큰 지팡이",c2:"거인의 허리띠",effect:"공격과 스킬 적중 시 10초 동안 불태우기 1%, 상처 33% 적용"},
{name:"내셔의 이빨",c1:"거인의 허리띠",c2:"곡궁",effect:"기본 공격 시 마나 2 획득, 치명타 시 마나 4 획득"},
{name:"수호자의 맹세",c1:"쇠사슬 조끼",c2:"여신의 눈물",effect:"전투 시작: 마나 20 획득. 생명선: 체력 40% 이하 시 마나 15 획득, 최대 체력의 20% 보호막"},
{name:"수은",c1:"음전자 망토",c2:"연습용 장갑",effect:"전투 시작: 18초 동안 군중 제어 면역. 매초 공격 속도 3% 획득"},
{name:"라바돈의 죽음모자",c1:"쓸데없이 큰 지팡이",c2:"쓸데없이 큰 지팡이",effect:"주문력 50 획득"},
{name:"붉은 덩굴정령",c1:"곡궁",c2:"곡궁",effect:"공격과 스킬 적중 시 5초 동안 불태우기 1%, 상처 33% 적용"},
{name:"쇼진의 창",c1:"B.F. 대검",c2:"여신의 눈물",effect:"기본 공격 시 추가 마나 5 획득"},
{name:"굳건한 심장",c1:"연습용 장갑",c2:"쇠사슬 조끼",effect:"내구력 10% 획득. 체력 50% 초과 시 내구력 18%로 증가"},
{name:"스테락의 도전",c1:"B.F. 대검",c2:"거인의 허리띠",effect:"생명선: 체력 60% 이하 시 최대 체력의 50% 보호막 획득 (5초에 걸쳐 감소)"},
{name:"타격대의 철퇴",c1:"거인의 허리띠",c2:"연습용 장갑",effect:"치명타 적중 시 5초 동안 피해 증폭 5% 획득 (최대 4회 중첩)"},
{name:"태양불꽃 망토",c1:"쇠사슬 조끼",c2:"거인의 허리띠",effect:"최대 체력 8% 획득. 2초마다 2칸 내 적에게 10초 동안 불태우기 1%, 상처 33% 적용"},
{name:"도적의 장갑",c1:"연습용 장갑",c2:"연습용 장갑",effect:"매 라운드 랜덤 아이템 2개 장착. 플레이어 레벨에 따라 향상. 아이템 슬롯 3칸 차지"},
{name:"거인의 결의",c1:"쇠사슬 조끼",c2:"곡궁",effect:"공격 또는 피격 시 공격력 2%, 주문력 2 획득 (최대 25중첩). 최대 중첩 시 방어력 15, 마법 저항력 15 획득 및 군중 제어 면역"},
{name:"공허의 지팡이",c1:"여신의 눈물",c2:"곡궁",effect:"공격과 마법 피해가 대상의 마법 저항력 30%를 5초 동안 관통 (중첩 불가)"},
{name:"워모그의 갑옷",c1:"거인의 허리띠",c2:"거인의 허리띠",effect:"최대 체력 12% 획득"},
{name:"정령의 형상",c1:"거인의 허리띠",c2:"여신의 눈물",effect:"전투 시작: 장착 유닛과 인접 아군에게 공격 속도 25%, 방어력 15, 마법 저항력 15 부여"},
{name:"크라켄의 분노",c1:"곡궁",c2:"음전자 망토",effect:"기본 공격 시 공격력 3% 중첩 획득 (최대 20회). 20회 도달 시 공격 속도 40% 획득"},
];
const NAMU_SET="https://namu.wiki/w/전략적 팀 전투/세트 16";
const NAMU_UNIT="https://namu.wiki/w/전략적 팀 전투/세트 16/유닛";
const NAMU_ITEM="https://namu.wiki/w/전략적 팀 전투/아이템";
const SYNERGY_WIKI={"공허":"3.1.1","그림자 군도":"3.1.2","녹서스":"3.1.3","다르킨":"3.1.4","데마시아":"3.1.5","빌지워터":"3.1.6","슈리마":"3.1.7","아이오니아":"3.1.8","요들":"3.1.9","이쉬탈":"3.1.10","자운":"3.1.11","타곤":"3.1.12","프렐요드":"3.1.13","필트오버":"3.1.14","기동타격대":"3.2.1","기원자":"3.2.2","난동꾼":"3.2.3","방해꾼":"3.2.4","비전 마법사":"3.2.5","엄호대":"3.2.6","원거리 사격":"3.2.7","전쟁기계":"3.2.8","총잡이":"3.2.9","토벌자":"3.2.10","파수꾼":"3.2.11","학살자":"3.2.12"};
const radiantItems=["찬란한 죽음의 검","찬란한 밤의 끝자락","찬란한 스테락의 도전","찬란한 마법공학 총검","찬란한 거인 학살자","찬란한 쇼진의 창","찬란한 피바라기","찬란한 무한의 대검","찬란한 덤불 조끼","찬란한 태양불꽃 망토","찬란한 크라운가드","찬란한 거인의 결의","찬란한 수호자의 맹세","찬란한 가고일 돌갑옷","찬란한 굳건한 심장","찬란한 워모그의 갑옷","찬란한 모렐로노미콘","찬란한 내셔의 이빨","찬란한 정령의 형상","찬란한 저녁갑주","찬란한 타격대의 철퇴","찬란한 라바돈의 죽음모자","찬란한 구인수의 격노검","찬란한 대천사의 지팡이","찬란한 이온 충격기","찬란한 보석 건틀릿","찬란한 붉은 덩굴정령","찬란한 공허의 지팡이","찬란한 크라켄의 분노","찬란한 최후의 속삭임","찬란한 푸른 파수꾼","찬란한 적응형 투구","찬란한 정의의 손길","찬란한 용의 발톱","찬란한 수은","찬란한 도적의 장갑"];
const artifactItems=["거대한 히드라","거물의 갑옷","고속 연사포","공허 건틀릿","도박꾼의 칼날","라이트실드 문장","루덴의 폭풍","리치베인","마법사의 최후","명멸검","무한한 삼위일체","방한 장갑","불굴","새벽심장","새벽의 방패","생선대가리","선체분쇄자","스태틱의 단검","승천의 부적","역병의 보석","영원한 겨울","영원한 서약","은빛 여명","자객의 발톱","저격수의 집중","존야의 역설","죽음의 저항","지옥불 손도끼","지평선의 초점","추적자의 팔목 보호대","카파 주스","황금 징수의 총","황혼의 방패","대장장이의 장갑","증강: 강철로부터 풀려난 봉인"];
const ITEM_WIKI={"죽음의 검":"3.2.1","밤의 끝자락":"3.2.2","스테락의 도전":"3.2.3","마법공학 총검":"3.2.4","거인 학살자":"3.2.5","쇼진의 창":"3.2.6","피바라기":"3.2.7","무한의 대검":"3.2.8","덤불 조끼":"3.2.9","태양불꽃 망토":"3.2.10","크라운가드":"3.2.11","거인의 결의":"3.2.12","수호자의 맹세":"3.2.13","가고일 돌갑옷":"3.2.14","굳건한 심장":"3.2.15","워모그의 갑옷":"3.2.16","모렐로노미콘":"3.2.17","내셔의 이빨":"3.2.18","정령의 형상":"3.2.19","저녁갑주":"3.2.20","타격대의 철퇴":"3.2.21","라바돈의 죽음모자":"3.2.22","구인수의 격노검":"3.2.23","대천사의 지팡이":"3.2.24","이온 충격기":"3.2.25","보석 건틀릿":"3.2.26","붉은 덩굴정령":"3.2.27","공허의 지팡이":"3.2.28","크라켄의 분노":"3.2.29","최후의 속삭임":"3.2.30","푸른 파수꾼":"3.2.31","적응형 투구":"3.2.32","정의의 손길":"3.2.33","용의 발톱":"3.2.34","수은":"3.2.35","도적의 장갑":"3.2.36"};

// ===== 시너지 효과 데이터 =====
const synergyEffects = {
// 지역 시너지
"공허":{base:"공허 유닛이 변이를 획득합니다.",tiers:[2,4,6,9],effects:{
  2:"변이 1개, 공격 속도 8%",
  4:"변이 2개, 공격 속도 18%",
  6:"변이 3개, 공격 속도 33%",
  9:"변이 폭주(위력 100% 증가), 공격 속도 40%"
}},
"그림자 군도":{base:"적 처치 시 영혼 수집. 그림자 군도 유닛이 영혼에 비례해 공격력/주문력을 얻습니다.",tiers:[2,3,4,5],effects:{
  2:"영혼 배율 1배, 공격력/주문력 18%",
  3:"영혼 배율 1.3배, 공격력/주문력 20%",
  4:"영혼 배율 1.6배, 공격력/주문력 25%",
  5:"영혼 배율 1.9배, 공격력/주문력 33%"
}},
"녹서스":{base:"녹서스 유닛이 충분한 피해를 받으면 아타칸을 소환합니다.",tiers:[3,5,7,10],effects:{
  3:"아타칸 소환 (체력 15% 손실 시)",
  5:"아타칸이 생존 시간에 따라 강화",
  7:"아타칸이 스킬 사용 시 영혼 흡수",
  10:"10초 후 파멸의 하강"
}},
"데마시아":{base:"데마시아 유닛이 결집 시 방어력/마법 저항력을 얻고, 스킬 비용이 10% 감소합니다.",tiers:[3,5,7,11],effects:{
  3:"방어력/마법 저항력 12",
  5:"방어력/마법 저항력 35",
  7:"방어력/마법 저항력 35, 결집 시 최대 체력 5% 피해",
  11:"방어력/마법 저항력 150"
}},
"빌지워터":{base:"전투 승리 시 바다뱀 은화를 획득합니다. 은화로 상점에서 전리품을 구매합니다.",tiers:[3,5,7,10],effects:{
  3:"은화 15 획득",
  5:"은화 35 획득, 향상된 전리품",
  7:"은화 65 획득, 상급 전리품",
  10:"은화 150 획득, 능력치 2배, 대포 발사"
}},
"슈리마":{base:"아지르가 슈리마 유닛을 강화합니다. 슈리마 해금 시마다 조건이 어려워집니다.",tiers:[2,3,4],effects:{
  2:"최대 체력 20%",
  3:"방어력/마법 저항력 50",
  4:"3초마다 신성 초월"
}},
"아이오니아":{base:"게임 시작 시 4가지 경로 중 1개를 선택합니다. 아이오니아 유닛이 보호막/공격력/주문력을 얻습니다.",tiers:[3,5,7,10],effects:{
  3:"경로 선택, 보호막/공격력/주문력 획득",
  5:"모든 효과 강화",
  7:"모든 효과 대폭 강화",
  10:"최종 강화 + 적 약화"
}},
"요들":{base:"고유 요들당 요들 유닛이 체력과 공격 속도를 얻습니다. 3성 요들은 2배.",tiers:[2,4,6,8,10],effects:{
  2:"고유 요들당 체력 40, 공격 속도 5%",
  4:"매 라운드 상점에 요들 포함",
  6:"매 라운드 무료 새로고침 1회",
  8:"요들 꾸러미 획득",
  10:"체력/공격 속도 100% 증가, 반들 시티 관문"
}},
"이쉬탈":{base:"퀘스트를 완료해 태양 파편을 수집합니다. 파편으로 보상을 획득합니다.",tiers:[3,5,7],effects:{
  3:"태양 파편 수집 시작",
  5:"플레이어 전투 시 체력 2 회복",
  7:"전투 승리 시 파편 50개 추가, 추가 전리품"
}},
"자운":{base:"자운 유닛이 주기적으로 시머를 주입받아 내구력과 공격 속도를 얻습니다.",tiers:[3,5,7],effects:{
  3:"4초마다 시머 주입 (내구력 15%, 공격 속도 90%)",
  5:"체력 60% 이하 시 30% 회복, 즉시 재주입",
  7:"시머 주입 효과 50% 강화, 3초마다 재주입"
}},
"타곤":{base:"시너지 효과 없음. 타곤 유닛은 개별적으로 강력합니다.",tiers:[],effects:{}},
"프렐요드":{base:"프렐요드 유닛이 체력과 피해 증폭을 얻습니다. 앞줄은 체력, 뒷줄은 피해 증폭을 더 얻습니다.",tiers:[3,5,7],effects:{
  3:"체력 8%, 피해 증폭 10%",
  5:"냉기 포탑 2개 소환, 체력 12%, 피해 증폭 16%",
  7:"포탑 파괴 시 기절, 체력 16%, 피해 증폭 22%"
}},
"필트오버":{base:"전투 8초 후 모듈이 활성화됩니다. 모듈을 선택해 다양한 효과를 얻습니다.",tiers:[2,4,6],effects:{
  2:"모듈 1개 선택",
  4:"모듈 2개 선택",
  6:"모듈 3개 선택"
}},
// 직업 시너지
"기동타격대":{base:"아군이 공격 속도를 얻습니다. 기동타격대는 잃은 체력에 비례해 추가 공격 속도를 얻습니다.",tiers:[2,3,4,5],effects:{
  2:"공격 속도 10~30%",
  3:"공격 속도 20~45%",
  4:"공격 속도 30~60%",
  5:"공격 속도 40~80%"
}},
"기원자":{base:"기원자가 스킬 시전 후 추가 마나를 획득합니다.",tiers:[2,4],effects:{
  2:"추가 마나 25%",
  4:"추가 마나 40%"
}},
"난동꾼":{base:"아군이 최대 체력 150을 얻습니다. 난동꾼은 추가 최대 체력을 얻습니다.",tiers:[2,4,6],effects:{
  2:"난동꾼 최대 체력 25% 증가",
  4:"난동꾼 최대 체력 45% 증가",
  6:"난동꾼 최대 체력 65% 증가"
}},
"방해꾼":{base:"방해꾼의 스킬이 적중한 적을 현혹시킵니다. 현혹된 적에게 추가 피해를 입힙니다.",tiers:[2,4],effects:{
  2:"현혹 대상에게 피해 18% 증가",
  4:"현혹 대상에게 피해 40% 증가"
}},
"비전 마법사":{base:"아군이 주문력을 얻습니다. 비전 마법사는 더 많이 얻습니다.",tiers:[2,4,6],effects:{
  2:"팀 주문력 18, 비전 마법사 25",
  4:"팀 주문력 25, 비전 마법사 40",
  6:"팀 주문력 40, 비전 마법사 60"
}},
"엄호대":{base:"아군이 방어력/마법 저항력을 얻습니다. 엄호대는 더 많이 얻습니다.",tiers:[2,4,6],effects:{
  2:"방어력/마법 저항력 30",
  4:"방어력/마법 저항력 55",
  6:"방어력/마법 저항력 80"
}},
"원거리 사격":{base:"원거리 사격 유닛이 피해 증폭을 얻고, 대상과 멀수록 추가 피해를 입힙니다.",tiers:[2,3,4,5],effects:{
  2:"피해 증폭 18% + 칸당 2%",
  3:"피해 증폭 24% + 칸당 3%",
  4:"피해 증폭 28% + 칸당 4%",
  5:"피해 증폭 32% + 칸당 5%"
}},
"전쟁기계":{base:"전쟁기계가 내구력을 얻습니다. 체력 50% 초과 시 수치가 증가합니다.",tiers:[2,4,6],effects:{
  2:"내구력 18% (체력 50% 초과 시 25%)",
  4:"내구력 20% (체력 50% 초과 시 30%)",
  6:"내구력 26% (체력 50% 초과 시 36%)"
}},
"총잡이":{base:"총잡이가 공격력을 얻고, 기본 공격 4회마다 추가 물리 피해를 입힙니다.",tiers:[2,4],effects:{
  2:"공격력 22%, 추가 피해 100",
  4:"공격력 40%, 추가 피해 200"
}},
"토벌자":{base:"토벌자의 스킬에 치명타가 적용됩니다. 치명타 확률과 치명타 피해를 얻습니다.",tiers:[2,3,4,5],effects:{
  2:"치명타 확률 15%, 치명타 피해 15%",
  3:"치명타 확률 20%, 치명타 피해 20%",
  4:"치명타 확률 25%, 치명타 피해 25%",
  5:"치명타 확률 30%, 치명타 피해 30%"
}},
"파수꾼":{base:"파수꾼의 체력이 75%, 25% 이하로 떨어지면 보호막을 얻습니다.",tiers:[2,3,4,5],effects:{
  2:"최대 체력의 16% 보호막",
  3:"최대 체력의 20% 보호막",
  4:"최대 체력의 26% 보호막",
  5:"최대 체력의 33% 보호막"
}},
"학살자":{base:"학살자가 공격력과 모든 피해 흡혈을 얻습니다.",tiers:[2,4,6],effects:{
  2:"공격력 22%, 모든 피해 흡혈 10%",
  4:"공격력 33%, 모든 피해 흡혈 16%",
  6:"공격력 44%, 모든 피해 흡혈 20%"
}},
// 고유 시너지
"관리인":{base:"바드 고유: 전투 중 수확물 생성",tiers:[1],effects:{1:"활성화"}},
"흡수자":{base:"카이사 고유: 스킬이 변경되어 적의 특성을 흡수",tiers:[1],effects:{1:"활성화"}},
"다르킨":{base:"다르킨 유닛이 피해 흡혈을 얻습니다.",tiers:[1,2,3],effects:{
  1:"피해 흡혈 15%",
  2:"플레이어 피해의 25%만큼 체력 회복",
  3:"체력 600 회복마다 2명에게 333 마법 피해"
}},
"종말의 화신":{base:"아트록스 고유: 모든 피해 흡혈의 150%만큼 공격력으로 전환. 첫 사망 시 부활",tiers:[1],effects:{1:"활성화"}},
"어둠의 아이":{base:"애니 고유: 티버를 소환합니다",tiers:[1],effects:{1:"활성화"}},
"황제":{base:"아지르 고유: 병사 2명을 소환합니다",tiers:[1],effects:{1:"활성화"}},
"수확자":{base:"피들스틱 고유: 적 사망 시 마나 10 획득, 다음 스킬 무료, 적 방어력/마법 저항력 -10",tiers:[1],effects:{1:"활성화"}},
"영웅":{base:"갈리오 고유: 대기석에서도 특성 적용. 결집 시 하늘에서 내려와 전투 합류",tiers:[1],effects:{1:"활성화"}},
"영원":{base:"킨드레드 고유: 같은 적 3회 공격 시 325% 추가 피해",tiers:[1],effects:{1:"활성화"}},
"영혼 결속":{base:"루시안과 세나 고유: 자리를 교환하며 서로에게 버프 부여. 한 명이 쓰러지면 나머지 강화",tiers:[1],effects:{1:"활성화"}},
"대장장이":{base:"오른 고유: 유물 아이템을 제작합니다",tiers:[1],effects:{1:"활성화"}},
"우두머리":{base:"세트 고유: 체력 45% 이하 시 윗몸일으키기. 회복 후 강화",tiers:[1],effects:{1:"활성화"}},
"용족":{base:"쉬바나 고유: 변신 시 피해 감소 8%",tiers:[1],effects:{1:"활성화"}},
"대식가":{base:"탐 켄치 고유: 챔피언을 삼켜 능력치를 영구 획득",tiers:[1],effects:{1:"활성화"}},
"헥스 기계":{base:"T-헥스 고유: 조종사 칸 1개 획득. 전투 시 합체",tiers:[1],effects:{1:"활성화"}},
"초월체":{base:"제라스 고유: 전투 후 주술 상점 등장. 주술 구매로 효과 획득",tiers:[1],effects:{1:"활성화"}},
"시간의 수호자":{base:"질리언 고유: 스킬 2회마다 경험치를 저장합니다",tiers:[1],effects:{1:"활성화"}},
"별의 창조자":{base:"아우렐리온 솔 고유: 별가루 획득량 증가 (1성 25%, 2성 30%, 3성 100%)",tiers:[1],effects:{1:"활성화"}},
"균열의 재앙":{base:"내셔 남작 고유: 팀 슬롯 2개 차지. 공허 특성 +2. 피해 증폭 30%",tiers:[1],effects:{1:"활성화"}},
"사냥꾼":{base:"니달리 고유: 기본 공격 대상 지정 불가, 내구력 획득",tiers:[1],effects:{1:"활성화"}},
"룬 마법사":{base:"라이즈 고유: 활성화된 지역 특성의 효과를 받습니다. 스킬 강화",tiers:[1],effects:{1:"활성화"}},
"쇄극자":{base:"사일러스 고유: 3가지 스킬을 번갈아 사용합니다",tiers:[1],effects:{1:"활성화"}},
"불멸자":{base:"자헨 고유: 결심을 중첩하여 사망 시 부활합니다",tiers:[1],effects:{1:"활성화"}},
};

// ===== 시너지→챔피언 맵 (챔피언에서 자동 산출) =====
const synergyMap = {};
champions.forEach(c => {
  c.traits.forEach(t => {
    if(!synergyMap[t]) synergyMap[t] = [];
    synergyMap[t].push(c.name);
  });
});

// 시너지 효과 퀴즈용: 고유 시너지(1인) 제외, 활성화 단계가 있는 것만
const quizSynergies = Object.keys(synergyEffects).filter(k => synergyEffects[k].tiers.length > 1);

// 해금 챔피언만 필터
const unlockChamps = champions.filter(c => c.unlock);

// ===== SRS (간격 반복) 시스템 =====
// Leitner Box: 0(새카드/틀림) ~ 5(완전숙달)
// 박스가 낮을수록 + 오래 안 볼수록 더 자주 출제
const STORAGE_KEY = 'tft_quiz_srs_v1';
const BOX_WEIGHTS = [32, 16, 8, 4, 2, 1]; // 박스별 가중치

function loadSRS() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) return JSON.parse(raw);
  } catch(e) {}
  return { cards: {}, stats: { qCount: 0, streak: 0, bestStreak: 0 } };
}

function saveSRS() { localStorage.setItem(STORAGE_KEY, JSON.stringify(srsData)); }

let srsData = loadSRS();

function getCard(key) {
  if (!srsData.cards[key]) {
    srsData.cards[key] = { box: 0, lastSeen: 0, correct: 0, wrong: 0 };
  }
  return srsData.cards[key];
}

function cardCorrect(key) {
  const c = getCard(key);
  c.box = Math.min(c.box + 1, 5);
  c.lastSeen = Date.now();
  c.correct++;
  srsData.stats.streak++;
  if (srsData.stats.streak > srsData.stats.bestStreak) srsData.stats.bestStreak = srsData.stats.streak;
  srsData.stats.qCount++;
  saveSRS();
}

function cardWrong(key) {
  const c = getCard(key);
  c.box = 0;
  c.lastSeen = Date.now();
  c.wrong++;
  srsData.stats.streak = 0;
  srsData.stats.qCount++;
  saveSRS();
}

// 모든 카드 풀 생성
function buildAllCards() {
  const all = [];
  champions.forEach(c => {
    all.push({ key:`cs:${c.name}`, type:'champSynergy', gen: () => {
      const costClass = `cost-${c.cost}`;
      return { qType:"챔피언 → 시너지",
        qText:`<span class="highlight">${c.name}</span> <span class="cost-badge ${costClass}">${c.cost}코스트</span>의 시너지를 모두 적으세요.`,
        wikiUrl:`${NAMU_UNIT}` };
    }});
  });
  Object.keys(synergyMap).forEach(trait => {
    const champs = synergyMap[trait];
    if (champs.length < 2) return;
    const sec = SYNERGY_WIKI[trait];
    all.push({ key:`sc:${trait}`, type:'synergyChamp', gen: () => ({
      qType:"시너지 → 챔피언",
      qText:`<span class="highlight">${trait}</span> 시너지를 가진 챔피언을 모두 적으세요. (${champs.length}명)`,
      wikiUrl: sec ? `${NAMU_SET}#s-${sec}` : NAMU_SET
    })});
  });
  unlockChamps.forEach(c => {
    all.push({ key:`ul:${c.name}`, type:'unlock', gen: () => {
      const costClass = `cost-${c.cost}`;
      return { qType:"해금 조건",
        qText:`<span class="highlight">${c.name}</span> <span class="cost-badge ${costClass}">${c.cost}코스트</span>의 해금 조건은?`,
        wikiUrl:`${NAMU_UNIT}` };
    }});
  });
  items.forEach(item => {
    all.push({ key:`it:${item.name}`, type:'item', gen: () => ({
      qType:"아이템 조합 + 효과",
      qText:`<span class="highlight">${item.name}</span>의 재료, 능력치, 효과를 적으세요.`,
      wikiUrl:`${NAMU_ITEM}#s-${ITEM_WIKI[item.name]||""}`
    })});
  });
  quizSynergies.forEach(syn => {
    const data = synergyEffects[syn];
    const sec = SYNERGY_WIKI[syn];
    all.push({ key:`se:${syn}`, type:'synergyEffect', gen: () => ({
      qType:"시너지 → 효과",
      qText:`<span class="highlight">${syn}</span> 시너지의 기본 효과와 활성화 단계(${data.tiers.join("/")})별 효과를 모두 적으세요.`,
      wikiUrl: sec ? `${NAMU_SET}#s-${sec}` : NAMU_SET
    })});
  });
  radiantItems.forEach((name, i) => {
    all.push({ key:`ri:${name}`, type:'radiantItem', gen: () => ({
      qType:"찬란한 아이템",
      qText:`<span class="highlight">${name}</span>의 효과를 적으세요.`,
      wikiUrl:`${NAMU_ITEM}#s-3.6.${i+1}`
    })});
  });
  artifactItems.forEach((name, i) => {
    all.push({ key:`ai:${name}`, type:'artifactItem', gen: () => ({
      qType:"유물 아이템",
      qText:`<span class="highlight">${name}</span>의 효과를 적으세요.`,
      wikiUrl:`${NAMU_ITEM}#s-3.5.${i+1}`
    })});
  });
  return all;
}

const allCards = buildAllCards();

// 가중치 기반 카드 선택 (틀린 카드가 훨씬 자주 등장)
function pickCard() {
  const types = [];
  document.querySelectorAll('.chk-group input:checked').forEach(el => types.push(el.dataset.type));
  if (!types.length) types.push('champSynergy');

  const pool = allCards.filter(c => types.includes(c.type));
  if (!pool.length) return pool[0];

  // 직전 문제와 같은 카드 제외
  const candidates = pool.length > 1 ? pool.filter(c => c.key !== currentCardKey) : pool;

  // 박스별 가중치로 뽑기 (낮을수록 자주)
  const weighted = candidates.map(card => ({ card, w: BOX_WEIGHTS[getCard(card.key).box] }));
  const total = weighted.reduce((s, x) => s + x.w, 0);
  let r = Math.random() * total;
  for (const item of weighted) {
    r -= item.w;
    if (r <= 0) return item.card;
  }
  return weighted[weighted.length - 1].card;
}

// 숙달도 계산
function getMastery() {
  const types = [];
  document.querySelectorAll('.chk-group input:checked').forEach(el => types.push(el.dataset.type));
  if (!types.length) types.push('champSynergy');
  const pool = allCards.filter(c => types.includes(c.type));
  if (!pool.length) return 0;
  const total = pool.reduce((sum, card) => {
    const c = getCard(card.key);
    return sum + c.box;
  }, 0);
  return Math.round((total / (pool.length * 5)) * 100);
}

// ===== UI 로직 =====
let currentCardKey = null;
let answerShown = false;

function updateStats() {
  document.getElementById('qNum').textContent = srsData.stats.qCount;
  document.getElementById('streak').textContent = srsData.stats.streak;
  document.getElementById('mastery').textContent = getMastery() + '%';
}

function showSrsInfo(key) {
  const c = getCard(key);
  const boxNames = ['새카드','학습중','반복중','기억중','숙달중','완전숙달'];
  document.getElementById('srsInfo').innerHTML =
    `<span class="box-tag box-${c.box}">${boxNames[c.box]}</span> `+
    `맞힘 ${c.correct}회 / 틀림 ${c.wrong}회`;
}

function showQuestion() {
  const picked = pickCard();
  if (!picked) return;
  currentCardKey = picked.key;
  const q = picked.gen();
  document.getElementById('qType').textContent = q.qType;
  document.getElementById('qText').innerHTML = q.qText;
  document.getElementById('answerContent').innerHTML = `<a href="${q.wikiUrl}" target="_blank" class="wiki-link">정답 확인하기 →</a>`;
  document.getElementById('answerBox').classList.remove('show');
  document.getElementById('userInput').value = '';
  document.getElementById('btnShow').style.display = '';
  document.getElementById('btnCorrect').style.display = 'none';
  document.getElementById('btnWrong').style.display = 'none';
  document.getElementById('userInput').focus();
  answerShown = false;
  showSrsInfo(currentCardKey);
  updateStats();
}

document.getElementById('btnShow').addEventListener('click', () => {
  document.getElementById('answerBox').classList.add('show');
  document.getElementById('btnShow').style.display = 'none';
  document.getElementById('btnCorrect').style.display = '';
  document.getElementById('btnWrong').style.display = '';
  answerShown = true;
});

document.getElementById('btnCorrect').addEventListener('click', () => {
  cardCorrect(currentCardKey);
  showQuestion();
});

document.getElementById('btnWrong').addEventListener('click', () => {
  cardWrong(currentCardKey);
  showQuestion();
});

// Ctrl+Enter로 정답 보기
document.getElementById('userInput').addEventListener('keydown', (e) => {
  if(e.key === 'Enter' && e.ctrlKey) {
    if(!answerShown) document.getElementById('btnShow').click();
  }
});

// 체크박스 변경 시 숙달도 갱신
document.querySelectorAll('.chk-group input').forEach(el => {
  el.addEventListener('change', updateStats);
});

// 초기화 버튼
document.getElementById('btnReset').addEventListener('click', () => {
  if(confirm('학습 기록을 모두 초기화하시겠습니까?')) {
    localStorage.removeItem(STORAGE_KEY);
    srsData = { cards: {}, stats: { qCount: 0, streak: 0, bestStreak: 0 } };
    showQuestion();
  }
});

showQuestion();
</script>
</body>
</html>
